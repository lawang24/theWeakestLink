{"ast":null,"code":"import { squareStyling } from \"./helpers\";\nexport const room_joined_handler = (socket, setRoomCode, setIsWhite) => {\n  socket.on(\"room_joined\", (roomCode, isWhite) => {\n    setRoomCode(roomCode);\n    setIsWhite(isWhite);\n  });\n};\nexport const next_turn_handler = (socket, game, setFen, setIsCheckmate, setGameStarted, setWhiteTurn, setTurn, isWhite, setCanSubmitMove, roomCode, setHistory, setSquareStyles) => {\n  socket.on(\"next_turn\", (worst_fen, nowWhiteTurn, target_square, source_square) => {\n    setFen(worst_fen);\n    game.load(worst_fen);\n    let kingSquare = null;\n    console.log(game.inCheck());\n    console.log(\"checkmate\");\n    console.log(game.isCheckmate());\n\n    // check highlighting\n    if (game.inCheck()) {\n      const pieceColor = nowWhiteTurn ? 'w' : 'b';\n      const boardInCheck = game.board();\n      for (let i = 0; i < boardInCheck.length; i++) {\n        kingSquare = boardInCheck[i].find(piece => piece && piece.type === 'k' && piece.color === pieceColor);\n        if (kingSquare) break;\n      }\n    }\n    setSquareStyles(squareStyling(source_square.current, target_square.current, kingSquare));\n\n    // check game conditions\n    if (game.isCheckmate()) {\n      setIsCheckmate(true);\n      setGameStarted(false);\n      setTurn(false);\n      setCanSubmitMove(false);\n      socket.emit(\"stop_game\", roomCode);\n    }\n    // allow the proper players to move \n    else {\n      setWhiteTurn(whiteTurn => !whiteTurn);\n      setTurn(turn => !turn);\n      if (isWhite === nowWhiteTurn) setCanSubmitMove(true);\n    }\n  });\n};\nexport const update_teams_handler = (socket, setWhiteTeam, setBlackTeam) => {\n  socket.on(\"update_white_team\", white_team => {\n    setWhiteTeam(new Map(JSON.parse(white_team)));\n  });\n  socket.on(\"update_black_team\", black_team => {\n    setBlackTeam(new Map(JSON.parse(black_team)));\n  });\n};\nexport const begin_game_handler = (socket, game, setWhiteTurn, setGameStarted, setFen, setIsCheckmate, setTimeOut, isWhite, setTurn, setCanSubmitMove) => {\n  socket.on(\"begin_game\", () => {\n    setWhiteTurn(true);\n    setGameStarted(true);\n    setFen(\"start\");\n    setIsCheckmate(false);\n    setTimeOut(false);\n    setSquareStyles({});\n    if (isWhite) {\n      setTurn(true);\n      setCanSubmitMove(true);\n    }\n    game.reset(); // restart the game\n  });\n};\n\nexport const timer_handler = (socket, setGameStarted, setTimeOut, setTurn, setCanSubmitMove, roomCode, setWhiteTime, setBlackTime) => {\n  socket.on(\"time_out\", () => {\n    setGameStarted(false);\n    setTimeOut(true);\n    setTurn(false);\n    setCanSubmitMove(false);\n    socket.emit(\"stop_game\", roomCode);\n  });\n  socket.on(\"update_timer\", timer => {\n    setWhiteTime(timer[0]);\n    setBlackTime(timer[1]);\n  });\n};\nexport function roomListeners(socket, setisHomescreen) {\n  socket.on(\"yes_room\", () => {\n    setisHomescreen(false);\n  });\n  socket.on(\"no_room\", () => {\n    alert(\"Game Not Found\");\n    console.log(\"alert!\");\n  });\n}\n;","map":{"version":3,"names":["squareStyling","room_joined_handler","socket","setRoomCode","setIsWhite","on","roomCode","isWhite","next_turn_handler","game","setFen","setIsCheckmate","setGameStarted","setWhiteTurn","setTurn","setCanSubmitMove","setHistory","setSquareStyles","worst_fen","nowWhiteTurn","target_square","source_square","load","kingSquare","console","log","inCheck","isCheckmate","pieceColor","boardInCheck","board","i","length","find","piece","type","color","current","emit","whiteTurn","turn","update_teams_handler","setWhiteTeam","setBlackTeam","white_team","Map","JSON","parse","black_team","begin_game_handler","setTimeOut","reset","timer_handler","setWhiteTime","setBlackTime","timer","roomListeners","setisHomescreen","alert"],"sources":["C:/Users/catas/Desktop/Basic Chess Game/client/src/handlers/socket_handlers.js"],"sourcesContent":["import { squareStyling } from \"./helpers\";\r\n\r\nexport const room_joined_handler = (socket, setRoomCode, setIsWhite) => {\r\n  socket.on(\"room_joined\", (roomCode, isWhite) => {\r\n    setRoomCode(roomCode);\r\n    setIsWhite(isWhite);\r\n  });\r\n};\r\n\r\nexport const next_turn_handler = (socket, game, setFen, setIsCheckmate, setGameStarted,\r\n  setWhiteTurn, setTurn, isWhite, setCanSubmitMove, roomCode, setHistory, setSquareStyles) => {\r\n\r\n  socket.on(\"next_turn\", (worst_fen, nowWhiteTurn, target_square, source_square) => {\r\n    setFen(worst_fen);\r\n    game.load(worst_fen);\r\n\r\n    let kingSquare = null;\r\n\r\n    console.log(game.inCheck());\r\n    console.log(\"checkmate\")\r\n    console.log(game.isCheckmate())\r\n\r\n    // check highlighting\r\n    if (game.inCheck()) {\r\n      const pieceColor = nowWhiteTurn ? 'w' : 'b';\r\n      const boardInCheck = game.board()\r\n      for (let i = 0; i < boardInCheck.length; i++) {\r\n        kingSquare = boardInCheck[i].find(piece => (piece && piece.type === 'k' && piece.color === pieceColor))\r\n        if (kingSquare) break;\r\n      }\r\n    }\r\n\r\n    setSquareStyles(squareStyling(source_square.current, target_square.current, kingSquare));\r\n\r\n    // check game conditions\r\n    if (game.isCheckmate()) {\r\n      setIsCheckmate(true);\r\n      setGameStarted(false);\r\n      setTurn(false);\r\n      setCanSubmitMove(false);\r\n      socket.emit(\"stop_game\", roomCode);\r\n    }\r\n    // allow the proper players to move \r\n    else {\r\n      setWhiteTurn((whiteTurn) => !whiteTurn);\r\n      setTurn((turn) => !turn);\r\n      if (isWhite === nowWhiteTurn) setCanSubmitMove(true);\r\n    }\r\n\r\n  });\r\n};\r\n\r\nexport const update_teams_handler = (socket, setWhiteTeam, setBlackTeam) => {\r\n  socket.on(\"update_white_team\", (white_team) => {\r\n    setWhiteTeam(new Map(JSON.parse(white_team)));\r\n  });\r\n\r\n  socket.on(\"update_black_team\", (black_team) => {\r\n    setBlackTeam(new Map(JSON.parse(black_team)));\r\n  });\r\n};\r\n\r\nexport const begin_game_handler = (socket, game, setWhiteTurn, setGameStarted, setFen, setIsCheckmate,\r\n  setTimeOut, isWhite, setTurn, setCanSubmitMove) => {\r\n\r\n  socket.on(\"begin_game\", () => {\r\n    setWhiteTurn(true);\r\n    setGameStarted(true);\r\n    setFen(\"start\");\r\n    setIsCheckmate(false);\r\n    setTimeOut(false);\r\n  setSquareStyles({});\r\n\r\n    if (isWhite) {\r\n      setTurn(true);\r\n      setCanSubmitMove(true);\r\n    }\r\n    game.reset(); // restart the game\r\n  });\r\n\r\n\r\n};\r\n\r\nexport const timer_handler = (socket, setGameStarted, setTimeOut, setTurn, setCanSubmitMove,\r\n  roomCode, setWhiteTime, setBlackTime) => {\r\n\r\n  socket.on(\"time_out\", () => {\r\n    setGameStarted(false);\r\n    setTimeOut(true);\r\n    setTurn(false);\r\n    setCanSubmitMove(false);\r\n    socket.emit(\"stop_game\", roomCode);\r\n  });\r\n\r\n  socket.on(\"update_timer\", (timer) => {\r\n    setWhiteTime(timer[0]);\r\n    setBlackTime(timer[1]);\r\n  });\r\n\r\n};\r\n\r\nexport function roomListeners(socket, setisHomescreen) {\r\n\r\n  socket.on(\"yes_room\", () => {\r\n    setisHomescreen(false);\r\n  });\r\n\r\n  socket.on(\"no_room\", () => {\r\n    alert(\"Game Not Found\");\r\n    console.log(\"alert!\");\r\n  });\r\n\r\n};\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}